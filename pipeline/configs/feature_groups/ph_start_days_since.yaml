prefix: 'ph_start_days_since'
from_obj: | # TODO same client+claim number has multiple svc_cat_grp_nbr, are we counting correctly?
  (
    select 
      client_id as entity_id,
      svc_start_dt
    from pretriage.cmu_physical_health_prm_id
  ) as ph_start

knowledge_date_column: 'svc_start_dt'

intervals: ['all']

aggregates_imputation:
  all:
    type: 'constant'
    value: 9999

aggregates:
  - # days since ph event start date:
    quantity:
      days_since: ('{collate_date}'::DATE - svc_start_dt::DATE)
    metrics:
      - min
  - # log days since ph event start date:
    quantity:
      days_since_log: log('{collate_date}'::DATE - svc_start_dt::DATE)
    metrics:
      - min