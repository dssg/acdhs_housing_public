prefix: 'hl_end'
from_obj: | 
  (
    select 
      client_id as entity_id,
      program_start_dt,
      program_end_dt,
      (program_end_dt - program_start_dt + 1) as days_hl
    from pretriage.homelessness_id
  ) as dhl

knowledge_date_column: 'program_end_dt'

intervals: ['all', '6month', '1 year', '3 year']

aggregates_imputation:
  all:
    type: 'zero_noflag'
    # value: -1 # TODO IMPUTE what if program_end_dt null, then days_hl null but it probably shouldn't be 0?

aggregates:
  - # how many days homeless 
    quantity: days_hl
    metrics: 
      - sum
      - avg
      - min
      - max