prefix: 'bh_days_since'
from_obj: |
  (
    select 
      client_id as entity_id,
      event_end_date
    from pretriage.cmu_behavioral_health_prm_id
  ) as bh

knowledge_date_column: 'event_end_date'

intervals: ['all']

aggregates_imputation:
  all:
    type: 'constant'
    value: 9999

aggregates:
  - # time since bh event_end_date
    quantity:
      days_since_bh: ('{collate_date}'::DATE - event_end_date::DATE)
    metrics:
      - min