prefix: 'hl_days_since'
from_obj: | 
  (
    select 
      client_id as entity_id,
      program_end_dt
    from pretriage.homelessness_id
  ) as dhl

knowledge_date_column: 'program_end_dt'

intervals: ['all'] 

aggregates_imputation:
  all:
    type: 'constant'
    value: 9999 

aggregates:
  - # days since most recent period of homelessness
    quantity:
      days_since_hl: ('{collate_date}'::DATE - program_end_dt::DATE)
    metrics:
      - min
  - # log days since most recent period of homelessness
    quantity:
      days_since_hl_log: log('{collate_date}'::DATE - program_end_dt::DATE)
    metrics:
      - min