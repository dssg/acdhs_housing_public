prefix: 'pr2' # split into two feature prefixes: too many columns
from_obj: | 
  (
    select 
      client_id as entity_id,
      program_start_dt,
      program_end_dt,
      dpt
    from pretriage.program_involvement_id
  ) as state_programs

knowledge_date_column: 'program_start_dt'

intervals: ['6month', '1 year']

aggregates_imputation:
  all:
    type: 'zero_noflag'
    # value: -1

aggregates:
  - # count number of involvements with programs
    quantity: dpt
    metrics:
      - count
  - # count number of involvements with unique programs
    quantity:
      uniq_programs: distinct dpt
    metrics:
      - count
  - # flag 1 if condition is current 
    quantity: 
      current_flag: case when '{collate_date}'::DATE < program_end_dt::DATE then 1 else 0 end 
    metrics:
      - max

categoricals_imputation:
  all:
    type: 'null_category'

categoricals:
  - # count number of involvements with each state program
    column: dpt
    # choice_query: select distinct dpt from pretriage.program_involvement_id;
    choices:
      - 'feed_1'
      - 'feed_10'
      - 'feed_103'
      - 'feed_104'
      - 'feed_105'
      - 'feed_11'
      - 'feed_114'
      - 'feed_115'
      - 'feed_116'
      - 'feed_117'
      - 'feed_118'
      - 'feed_119'
      - 'feed_12'
      - 'feed_120'
      - 'feed_121'
      - 'feed_122'
      - 'feed_123'
      - 'feed_124'
      - 'feed_125'
      - 'feed_126'
      - 'feed_128'
      - 'feed_13'
      - 'feed_130'
      - 'feed_131'
      - 'feed_132'
      - 'feed_133'
      - 'feed_134'
      - 'feed_135'
      - 'feed_136'
      - 'feed_138'
      - 'feed_139'
      - 'feed_14'
      - 'feed_140'
      - 'feed_141'
      - 'feed_142'
      - 'feed_143'
      - 'feed_145'
      - 'feed_146'
      - 'feed_147'
      - 'feed_148'
      - 'feed_149'
      - 'feed_15'
      - 'feed_150'
      - 'feed_151'
      - 'feed_152'
      - 'feed_153'
      - 'feed_154'
      - 'feed_155'
      - 'feed_156'
      - 'feed_158'
      - 'feed_159'
      - 'feed_161'
      - 'feed_162'
      - 'feed_164'
      - 'feed_165'
      - 'feed_166'
      - 'feed_167'
      - 'feed_168'
      - 'feed_17'
      - 'feed_170'
      - 'feed_171'
      - 'feed_172'
      - 'feed_173'
      - 'feed_174'
      - 'feed_175'
      - 'feed_176'
      - 'feed_178'
      - 'feed_179'
      - 'feed_18'
      - 'feed_180'
      - 'feed_181'
      - 'feed_182'
      - 'feed_183'
      - 'feed_184'
      - 'feed_185'
      - 'feed_186'
      - 'feed_187'
      - 'feed_188'
      - 'feed_189'
      - 'feed_190'
      - 'feed_191'
      - 'feed_192'
      - 'feed_193'
      - 'feed_194'
      - 'feed_195'
      - 'feed_196'
      - 'feed_197'
      - 'feed_198'
      - 'feed_199'
      - 'feed_2'
      - 'feed_2000'
      - 'feed_201'
      - 'feed_202'
      - 'feed_203'
      - 'feed_204'
      - 'feed_205'
      - 'feed_206'
      - 'feed_207'
      - 'feed_208'
      - 'feed_209'
      - 'feed_21'
      - 'feed_210'
      - 'feed_211'
      - 'feed_212'
      - 'feed_213'
      - 'feed_214'
      - 'feed_215'
      - 'feed_216'
      - 'feed_217'
      - 'feed_22'
      - 'feed_23'
      - 'feed_243'
      - 'feed_244'
      - 'feed_245'
      - 'feed_246'
      - 'feed_247'
      - 'feed_248'
      - 'feed_249'
      - 'feed_25'
      - 'feed_250'
      - 'feed_251'
      - 'feed_252'
      - 'feed_253'
      - 'feed_254'
      - 'feed_255'
      - 'feed_256'
      - 'feed_257'
      - 'feed_258'
      - 'feed_259'
      - 'feed_26'
      - 'feed_260'
      - 'feed_261'
      - 'feed_262'
      - 'feed_263'
      - 'feed_264'
      - 'feed_265'
      - 'feed_266'
      - 'feed_267'
      - 'feed_268'
      - 'feed_269'
      - 'feed_27'
      - 'feed_270'
      - 'feed_271'
      - 'feed_272'
      - 'feed_273'
      - 'feed_274'
      - 'feed_275'
      - 'feed_277'
      - 'feed_278'
      - 'feed_279'
      - 'feed_28'
      - 'feed_280'
      - 'feed_281'
      - 'feed_282'
      - 'feed_283'
      - 'feed_284'
      - 'feed_285'
      - 'feed_286'
      - 'feed_287'
      - 'feed_288'
      - 'feed_289'
      - 'feed_29'
      - 'feed_290'
      - 'feed_291'
      - 'feed_292'
      - 'feed_293'
      - 'feed_294'
      - 'feed_295'
      - 'feed_296'
      - 'feed_297'
      - 'feed_298'
      - 'feed_299'
      - 'feed_3'
      - 'feed_30'
      - 'feed_300'
      - 'feed_301'
      - 'feed_302'
      - 'feed_303'
      - 'feed_304'
      - 'feed_305'
      - 'feed_306'
      - 'feed_307'
      - 'feed_308'
      - 'feed_309'
      - 'feed_31'
      - 'feed_310'
      - 'feed_311'
      - 'feed_312'
      - 'feed_313'
      - 'feed_314'
      - 'feed_315'
      - 'feed_316'
      - 'feed_317'
      - 'feed_318'
      - 'feed_319'
      - 'feed_32'
      - 'feed_320'
      - 'feed_321'
      - 'feed_322'
      - 'feed_324'
      - 'feed_325'
      - 'feed_326'
      - 'feed_327'
      - 'feed_328'
      - 'feed_329'
      - 'feed_33'
      - 'feed_330'
      - 'feed_331'
      - 'feed_332'
      - 'feed_333'
      - 'feed_334'
      - 'feed_335'
      - 'feed_336'
      - 'feed_337'
      - 'feed_338'
      - 'feed_339'
      - 'feed_34'
      - 'feed_340'
      - 'feed_341'
      - 'feed_35'
      - 'feed_36'
      - 'feed_37'
      - 'feed_38'
      - 'feed_39'
      - 'feed_40'
      - 'feed_41'
      - 'feed_42'
      - 'feed_43'
      - 'feed_44'
      - 'feed_45'
      - 'feed_46'
      - 'feed_47'
      - 'feed_48'
      - 'feed_49'
      - 'feed_5'
      - 'feed_50'
      - 'feed_51'
      - 'feed_52'
      - 'feed_53'
      - 'feed_54'
      - 'feed_55'
      - 'feed_56'
      - 'feed_57'
      - 'feed_58'
      - 'feed_59'
      - 'feed_6'
      - 'feed_60'
      - 'feed_61'
      - 'feed_62'
      - 'feed_65'
      - 'feed_66'
      - 'feed_67'
      - 'feed_68'
      - 'feed_69'
      - 'feed_7'
      - 'feed_70'
      - 'feed_71'
      - 'feed_73'
      - 'feed_74'
      - 'feed_75'
      - 'feed_76'
      - 'feed_77'
      - 'feed_78'
      - 'feed_79'
      - 'feed_8'
      - 'feed_80'
      - 'feed_81'
      - 'feed_82'
      - 'feed_83'
      - 'feed_84'
      - 'feed_85'
      - 'feed_86'
      - 'feed_87'
      - 'feed_88'
      - 'feed_89'
      - 'feed_9'
      - 'feed_90'
      - 'feed_91'
      - 'feed_92'
      - 'feed_93'
      - 'feed_94'
      - 'feed_96'
      - 'feed_97'
      - 'feed_98'
      - 'feed_99'
      - 'hmis_0716D9708D'
      - 'hmis_0A57CB53BA'
      - 'hmis_0ADE7C2CF9'
      - 'hmis_12C6FC06C9'
      - 'hmis_1574BDDB75'
      - 'hmis_22D200F867'
      - 'hmis_356A192B79'
      - 'hmis_4D134BC072'
      - 'hmis_5B384CE32D'
      - 'hmis_632667547E'
      - 'hmis_7719A1C782'
      - 'hmis_77DE68DAEC'
      - 'hmis_887309D048'
      - 'hmis_91032AD7BB'
      - 'hmis_9E6A55B6B4'
      - 'hmis_B1D5781111'
      - 'hmis_B3F0C7F6BB'
      - 'hmis_BC33EA4E26'
      - 'hmis_C1DFD96EEA'
      - 'hmis_CB7A1D775E'
      - 'hmis_D435A6CDD7'
      - 'hmis_DA4B9237BA'
      - 'hmis_F1ABD67035'
      - 'hmis_F6E1126CED'
      - 'hmis_FA35E19212'
      - 'hmis_FC074D5013'
      - 'hmis_FE5DBBCEA5'
      - 'hmis_ph_waiting_list_0'
      - 'hmis_ph_waiting_list_1'
      - 'hmis_ph_waiting_list_11'
      - 'hmis_ph_waiting_list_12'
      - 'hmis_ph_waiting_list_13'
      - 'hmis_ph_waiting_list_2'
      - 'hmis_ph_waiting_list_3'
      - 'hmis_ph_waiting_list_4'
      - 'hmis_ph_waiting_list_6'
      - 'hmis_ph_waiting_list_7'
      - 'hmis_ph_waiting_list_8'
      - 'hmis_ph_waiting_list_9'

    metrics:
      - sum